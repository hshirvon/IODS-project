# Regression and model validation

#Heidi Hirvonen 11.11.2020 
#This week we have been learning regression

- Describe your work and results clearly. 
- Assume the reader has an introductory course level understanding of writing and reading R code as well as statistical methods.
- Assume the reader has no previous knowledge of your data or the more advanced methods you are using.

```{r}
date()

#1. 
heididata <- read.table("data/heidindata.csv", sep=",", header=TRUE)
#Explore the structure and the dimensions of the data 
str(heididata)
dim(heididata)
#The dataset "newdata" includes 8 variables and 166 observations. 
#It is a subdata of an international survey of Approaches to Learning, which has been collected 3.12.2014 - 10.1.2015. The variables included in the  "heididata" are gender, age, attitude, deep learning, strategic learning, surface learning, points and a running variable X.

#2. Graphical overview
plot(heididata)
summary(heididata)
#The age of the respondents is between 17 and 55;  attitude approximately 1,4 - 5,0; deep learning approximately 1.6 - 4,9; strategic learning approximately 1,3 - 5,0; surface learning approximately 1,6 - 4,3 and points 7 - 33. 

# 3. My regression model explains the target (dependent) variable, exam points, with gender, strategic learning and attitude. 
my_regression <- lm(lrn14.Points ~ sukupuoli + lrn14.Age + lrn14.Attitude , data = heididata)
#Print out a summary of my regression model
summary(my_regression)
#The regression model explains the target (dependent) variable, exam points, with gender, strategic learning and attitude. Attitude has a statistically significant relationship with Points, but gender and age do not. 

#Running the regression again with just attitude as the explanatory variable and print out a summary of the regression model:
my_regression2 <- lm(lrn14.Points ~ lrn14.Attitude , data = heididata)
summary(my_regression2)

#4. Since gender and age did not have a statistically significant effect, I will analyze the summary of the my_regression2 with attitude as the explanatory variable. 

#The coefficient is 3.25, meaning that when the explanatory variable (attitude) moves one unit, the target variable moves 3.25 units. One unit better attitude, should result in 3.25 more points! 

#The multiple R squared of the model is 0.1906. This means how much of the model is explained by attitude.

#5.

# I am using the linear model object "my_regression" with several explanatory variables that was created earlier
#This will place the following 4 graphics to the same plot:
par(mfrow = c(2,2))

#Calling the plot function with 1 (Residuals vs Fitted values), 2 (Normal QQ-plot) & 5 (Residuals vs Leverage). 
plot(my_regression,which=c(1,2,5)) 
#Explain the assumptions of the model and interpret the validity of those assumptions based on the diagnostic plots. (0-3 points)

```
